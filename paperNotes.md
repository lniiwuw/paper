# **1.** Wang Price Trust_CECEEE08

**可参考文中模型参数设置的实验**

提出了一种新的信任管理系统，在一定程度上提供信息来指示卖方在报价下的信任水平。本文提出了一种价格信任评估方法和市场价格计算方法。

文中构建了一种数据结构，并基于此数据结构假设了价格信任的一些原则，通过转换相似性质的函数去模拟（文中模拟的函数全为双曲函数）。通过不断改进市场价格的计算方法，最终提出了一种迭代算法。第四部分，通过购物网站上的实例进行价格信任评估研究。

 

# **2.** 适应性治疗策略的研究进展

适应性治疗是一种最初为癌症治疗而设计的新型治疗策略，其通过间隔给药的方式维持药物敏感癌细胞在数量上的相对优势，进而通过生长竞争抑制药物耐受癌细胞数量，最终延缓甚至消除常规治疗后期出现的癌细胞耐药现象（相比于药物敏感性癌细胞亚群，药物耐受癌细胞在细胞代谢等方面通常需要更多的“代偿( trade-offs) ”效应来维持耐药特征，因而其在生长和增殖方面具有劣势。引入适应性治疗方式可以在较小药物剂量下控制异质性肿瘤的发展。）

本文将围绕适应性治疗策略的相关研究，介绍该治疗策略的理论基础、相关论证进展及在临床治疗癌症和感染中的应用价值，探讨其在临床上的应用前景。

 

# **3.** 基于达尔文演化动力学的适应性治疗策略在肿瘤治疗中的研究进展

伴随辅助化疗药物和靶向治疗药物的耐药问题以及随之而来的病情迅速进展一直是癌症治疗领域的痛点。揉合了达尔文演化动力学的肿瘤适应性治疗（adaptive therapy，AT）是有别于传统最大耐受剂量（maximum tolerated dose，MTD）的新颖治疗理念，有望颠覆晚期癌症的治疗范式，实现患者长期的低负荷带瘤生存。

本文对适应性治疗理论的研究进展进行综述，介绍了两种在AT研究中被广泛使用的模型，即Lotka-Volterra模型和代理人基模型（agent-based model，ABM），它们模拟了AT治疗策略下的肿瘤动力学。同时简短介绍了其他演化治疗策略。

注：

1. Lotka-Volterra模型，也称为食物链模型，是一种用于描述生态系统中物种相互作用的数学模型，以两个不同的微分方程表示掠食者和猎物之间的相互作用，通常用于研究捕食者与猎物之间的关系。在AT研究中，可以用于模拟不同治疗策略（如放疗、化疗等）对肿瘤细胞和正常细胞的影响。
2. 代理人基模型（Agent-Based Model，ABM）是一种计算模型，用于模拟和分析个体代理人（通常是虚拟的）在特定环境中的行为和互动。每个代理人都具有自己的属性、目标、行为规则和决策策略。针对癌症患者，代理人基模型可以根据患者的病情、遗传信息和生活方式等因素来模拟不同的治疗策略。这可以帮助医生选择最适合每个患者的治疗方案，以提高治疗效果和减少不必要的副作用。



# 4.Evolutionary Dynamics and Intermittent Therapy for Metastatic Cancers

区别于适应性治疗的间歇治疗（两者进化原则存在差异，适应性治疗显示出更为积极的结果），利用进化原理来延迟耐药性的发作，同时减少累积的药物剂量和降低毒性。

间歇治疗诱导序列：应用治疗时，敏感细胞会减少，而耐药细胞会保持稳定或增加。当停止治疗时，所有癌症细胞都会增殖，但当治疗敏感细胞因其在没有治疗的情况下的适应性优势而超过并抑制耐药细胞的生长时，就会获得进化益处。因此，当重新开始治疗时，敏感/耐药细胞的规模比率与其预处理值相似，从而产生类似的临床反应。（另：文中介绍了诱导周期）

间歇性治疗方案反映了利用进化原理进行控制不同和不相容的目标，同时也最大限度地增加癌症细胞死亡。



# 5.Optimizing Cancer Treatment Using Game Theory

研究癌症治疗是医生治疗和癌症细胞抵抗策略之间的博弈论游戏。这个游戏有两个关键的不对称性：

（1）只有医生才能理性地玩。癌症细胞和所有进化中的生物一样，只能适应当前的条件；他们既不能预测也不能进化出对医生尚未应用的治疗的适应。

（2） 它具有独特的领导者-追随者（或“Stackelberg”）动态；

“领导者”肿瘤学家首先发挥作用，“追随者”癌症细胞随后反应并适应治疗。目前转移性癌症的治疗方案通常没有利用不对称性。通过反复服用相同的药物直到疾病进展，医生“发挥”了一种固定的策略，即使对立的癌症细胞不断进化出成功的适应性反应。此外，通过只在肿瘤进展时改变治疗，医生将领导权交给癌症细胞，治疗失败几乎是不可避免的。在策略没有根本改变的情况下，癌症标准治疗通常会产生“纳什解决方案”，在这种解决方案中，治疗的单方面改变不能有利地改变结果。

医生需要利用癌症治疗游戏不对称的固有优势，并通过采用更动态的治疗方案来改善结果，这些方案整合了生态进化动力学并相应地调节治疗。实施这种方法将需要新的肿瘤反应指标，包括生态（即大小）和进化（即耐药性的分子机制和耐药性群体的相对大小）的变化。



# 7.A Note on Stackelberg Games（无用）

论文比较了纳什博弈和斯塔克伯格博弈。在Nash博弈中，一个玩家变为领导者leader，他的汇报函数值将会增加，即在Stackelberg博弈中，如果领导者在Nash博弈中扮演一个普通玩家，他/她的回报函数值将减少。

文中得出结论，如果纳什博弈中的一名玩家在相应的斯塔克伯格博弈中转变为领导者，而其他玩家充当追随者，他/她将从中受益。



# 8.工程博弈论

![image-20240227142929811](https://cdn.jsdelivr.net/gh/lniiwuw/figureBed//img/image-20240227142929811.png)

# 9.Integrating evolutionary dynamics into treatment of metastatic castrate-resistant prostate cancer

## 摘要

阿比特龙（Abiraterone）通过抑制CYP17A（一种促进睾丸素生成的酶）治疗转移性去势抵抗性前列腺癌。在标准剂量下，模拟显示雄激素非依赖性细胞的强性选择，治疗失败的耐药性演变发生在16.5个月（进展时间TTP）左右。基于Lotka-Volterra方程建立演化博弈模型，包含三种相互竞争的癌症细胞：雄激素依赖型、雄激素产生型、雄激素非依赖型。利用患者特异性肿瘤动力学来通知治疗周期，抑制雄激素非依赖性细胞的增殖并降低累积药物剂量，进行适应性治疗。临床试验中，（10/11)名患者维持稳定的肿瘤负荷震荡，进展时间延长到27个月，累计用药减少47%。

## 介绍

耐药性进化是癌症治疗失败和肿瘤进展的主要原因。传统的治疗策略是以最大药物剂量（`MTD`）给予细胞毒性药物直到疾病发展，此策略会选择耐药细胞并消除竞争对手，导致抗性种群的快速繁殖，在进化学上不明智。

应用了进化原理的治疗策略，通过抑制耐药群体的出现来延长肿瘤控制时间。在没有药物治疗期间，耐药细胞相比于药物敏感细胞增加了存活所需要的分子机制的合成、维持和操作的进化成本，在资源有限的环境中更不适应。==适应性治疗==：以适当时间退出治疗，让剩余的敏感细胞群体利用成本优势抑制抗性群体的繁殖，直到下一次治疗，此时耐药群体仍然很小，使用药物治疗依旧有效。

从概念上讲，治疗和细胞抗药性的进化代表了癌症、肿瘤学家、不同类型癌症细胞之间的进化博弈。癌细胞作为参与者，策略是遗传表型，收益是以增殖和生存的形式出现。癌细胞的存活和增殖可受其自身表型、其他细胞表型和不同类型癌细胞总体丰度的影响。

<img src="https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240424095738282.png" alt="image-20240424095738282" style="zoom: 67%;" />

本文重点聚焦转移性前列腺癌（`mPC`）的治疗。mPC的一线治疗采用雄激素剥夺疗法（`ADT`），但几乎所有男性进展到转移性去势抵抗性前列腺癌(`mCRPC`)阶段。抗ADT的一个常见机制是`CYP17A1`（雄激素合成的关键酶）的表达增加，这会产生一个自分泌循环，补充肿瘤内的睾酮浓度。阿比特龙是一种CYP17A1抑制剂，可降低`PSA`（前列腺特异性抗原）。

SWOG9346试验将去势敏感性mPC患者随机分为连续或间接ADT治疗组，经过9.8年（中位数）的随访，发现两种方案均无优越性，治疗方案和肿瘤内进化动力学之间缺乏明确的联系。例如，该方案从8个月的“诱导期”开始，持续进行高剂量治疗。仅当PSA < 4ng/ml时停止治疗。在下文的计算模型中，这种试验设计在诱导期间消除几乎所有的敏感细胞，促进竞争性释放，几乎与连续高剂量治疗相同。

对临产标本观察提出三种竞争细胞：

1. $T+$ 依赖外源性雄激素 
2. $TP$（testosterone producing）表达CYP17A1并产生睾酮（即产生雄激素）
3. $T-$ 不依赖雄激素且对阿比特龙耐药

根据它们与睾酮的相互作用来定义相关的肿瘤内亚群，基于进化原理的博弈论模型构建阿比特龙治疗前和治疗期间的种群动态，并根据临床可用数据进行参数估计。传统MTD治疗的计算机模拟结果与观察到的临床结果一致：$T-$细胞迅速增加。建模结果随后证明了与肿瘤内进化动力学同步的适应性治疗策略如何延长进展时间并显著降低总药物剂量。

## 结果

### 模型模拟结果

下图模拟结果表明，当$Tp$、$T+$和$T-$细胞混合物生长到致死的群体大小时，未经治疗的肿瘤将导致较大的肿瘤体积。ADT疗法针对$T+$细胞，但是它们可以获取$Tp$细胞产生的睾丸激素继续存在，并且不需要任何的成本消耗。在mCRPC中，传统的持续应用阿比特龙治疗MTD会消除$Tp$细胞和$T+$细胞，导致$T-$细胞的竞争性释放和肿瘤进展。在长期MTD治疗“诱导期”后进行间歇性治疗的模拟显示，进展与连续MTD治疗相当。

<img src="https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240424102725236.png" alt="image-20240424102725236" style="zoom: 67%;" />

模型模拟表明，进化动力学可以保护敏感的$T+$和$Tp$细胞。==当PSA下降到预处理值得一半时停止阿比特龙治疗，允许肿瘤再生，此时敏感细胞更加====适应当前环境，保持优势群体地位==。通过这种方式，治疗后的肿瘤群体与治疗前的肿瘤几乎相同，允许阿比特龙再治疗以维持多个周期的肿瘤控制。

<img src="https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240424104252901.png" alt="image-20240424104252901" style="zoom:67%;" />

阿比特龙治疗前的肿瘤组成决定患者的适应性治疗结果：

<img src="https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240424105415212.png" alt="image-20240424105415212" style="zoom:67%;" />

对于较小$T+$细胞群体的病人（图5的1003、1005、1007），其PSA值需要更长的时间才能达到退却PSA值，因此需要更长的周期时间。或者说，更高的$T+$细胞群体导致更短的周期时间。但是两种情况都允许治疗期间$T-$细胞的少量增加，随着周期增多，耐药细胞数量增多，最后导致治疗失败（进展时间比MTD长）。

<img src="https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240424110703173.png" alt="image-20240424110703173" style="zoom:67%;" />

模拟治疗方案的竞争释放时间(与临床进展相对应)见表1。

<img src="https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240424111116859.png" alt="image-20240424111116859"  /><img src="https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240424111240074.png" alt="image-20240424111240074" style="zoom:80%;" />

### 临床试验与统计

在撰写本文时，11名患者（表2和图5）进行了$\gt10$月的试验，可以与同期队列和历史对照进行比较。根据数学模型预测，PSA的周期长度范围从3个月到$\gt1$年。根据图5试验队列的临床现状，4例患者完成了2个适应周期，当阿比特龙在第3个周期(主要终点)重新启动时，所有4例患者的PSA均下降了> 50%；1例患者在第11个月出现PSA和影像学进展；两名患者在21个月和28个月时表现出PSA进展，但仍在试验中，没有放射学进展；两名患者分别在第17个月和第20个月拒绝继续使用Leuprolide(一种ADT，作为任何阿比特龙治疗的一部分持续使用)抑制GnRH，但继续服用阿比特龙。

适应性治疗由于阿比特龙的给药/不给药的循环，与标准治疗中使用的连续给药相比，平均累积剂量仅为47%(图5;表2)。11例患者中有3例接受了< 25%的累积SOC剂量。

Ryan等人的一项研究提供了一个历史性的组来比较持续阿比特龙治疗时PSA进展和放射学进展的时间，在3期AA 302试验中，报告了PSA进展和放射学进展的中位时间分别为11.1和16.5个月，虽然当前适应性治疗队列尚未达到PSA或放射学进展的中位时间，但进展时间可以不少于27个月。

适应性治疗的3例患者在11、21、28个月观察到PSA进展，考虑到三期试验中546名患者，可以使用一个列连表检验实用性治疗的疗效。由于11例患者中只有1例患者的PSA进展时间$\lt11.1$月，采用$Fisher$精确检验（$p=0.006$），试验组的PSA进展时间中位数明显更高。在3期试验中，报告的放射学进展的中位数时间（TTP）为16.5个月，虽然平均TTP未报告，但不能高于17.2个月（满足进展时间的泊松分布或二项分布）。假设试验组患者在撰写本文时放射学突然进展（实际只有一个），平均TTP$\ge24$个月。泊松精确检验将11例患者与17.2的平均值进行比较，得出$p < 0.001 (z = 4.10)$。使用泊松精确检验来检验适应性治疗的平均值$<17.2$（个人认为此处为$>17.2$）的可能性，得到$p = 0.98$​。即使样本量很小，对于放射学进展，我们也可以证明适应性治疗的优越性。

### 讨论

试验验证了一个使用数学模型将进化原理整合到mCRPC的阿比特龙治疗中的方法，中期分析表明，此方法在临床上可行：增加了进展时间，同时将累积药物剂量减少到<标准治疗的1/2。

模型基于关键亚群相互竞争的假设，因此存在一定程度的空间混合，适用于mCRPC，但可能不适用于其他肿瘤类型。

### 方法

#### 进化亚种群

前列腺癌转移都是一个开放的复杂动态系统，不能用现有的临床资料参数化。因此，提出的模型只包含了肿瘤细胞与关键环境因子治疗-睾酮之间的相互作用。假设有三种竞争细胞亚种群：

1. $T+$ 依赖外源性雄激素       
2. $TP$（testosterone producing）表达CYP17A1并产生睾酮（即产生雄激素）
3. $T-$ 不依赖雄激素且对阿比特龙耐药

#### 数学模型

使用$Lotka-Volterra (LV)$竞争方程来模拟$T+$， $Tp$和$T-$细胞类型之间的相互作用$(i = 1,2,3)$。$LV$方程要求参数：生长率$r_i$，承载能力$K_i$。
$$
\frac{dx_i}{dt}={r_ix_i(1-\frac{\sum_{(j=1)}^{3}{a_{ij}x_j}}{K_i})}
$$
其中$a_{ij}$为竞争矩阵，$\alpha_{ij}$ 表示$j$ 型个体对$i$ 型个体生长速率的影响。

![image-20240426101838333](https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240426101838333.png)

固有生长速率可以通过相应细胞系的倍增次数进行参数化，ATCC@CRL-1740 LNCaP、 ATCC@CRL-2128 H295R和ATCC®CRL-1435 PC-3细胞系分别对应$T+$、$Tp$和$T-$细胞。在该方法下，$r_i={0.278,0.355,0.665}$。在实际情况下，体内细胞的增长速率到达不了$r_i$，可能代表了其上限。因此，在接下来的模拟中，将$r_i$调整为原本的$10\%$（==注：实验代码中使用的增长率为$r*0.01$==）。在没有阿比特龙的情况下，内在生长速率不影响三种细胞类型的平衡频率。而且在使用阿比特龙的情况下，只要不同细胞类型的r值具有相同的数量级，适应性治疗与标准护理的定性循环和有效性是稳健的。 

在缺乏睾酮的情况下（ADT治疗期间），$T+$细胞的承载完全依赖于$Tp$细胞产生的睾酮，假设$K1=1.5x_2$，即允许每个$Tp$细胞支持$1.5$个$T+$细胞生长。假设$Tp$的承载能力$K_2=10000$。因为不知道阿比特龙是否会导致细胞死亡或静默，我们可以通过降低$K_2$来模拟阿比特龙治疗。假设阿比特龙使得$K_2$降到100，则治疗中$K_2\in[100,10000]$。此外，阿比特龙会抑制$Tp$细胞产生睾酮，削弱维持$T+$细胞的能力，故在阿比特龙治疗期间令$K_1=0.5x_2$。$T-$细胞不受阿比特龙和$Tp$细胞产生睾酮能力的影响，因此承载能力保持恒定（令$K_3=10000$）。模型结果不受$K$实际大小影响。

模型的大部分行为取决于竞争矩阵，用于衡量细胞间类型的竞争效应和描述癌细胞之间的进化博弈。$\alpha_{ij}$ 表示$j$ 型个体对$i$ 型个体生长速率的影响（理解：$i$型个体在$j$型个体影响后的生长速率，$\alpha$值越小表示竞争越强），由于同一类型的个体可以互换，令$\alpha_{ii}=1$，并假设$0\lt \alpha_{ij}\lt1,i\ne j$。

两个大体规则决定了癌细胞之间的竞争系数大小关系（$1.T+$     $2.Tp$      $3.T-$）：

1. $T+$细胞是竞争最弱的类型。
2. $T-$细胞对$TP$细胞的竞争作用强于$T+$细胞。

在上述规则下有：$α31 > α21, α32 > α12, α13 > α23, α13 > α12, α23 > α21, α32 > α31$​。

满足上述六个不等式条件的竞争系数有22种不同的秩序。$Li$等人使用一个空间明确的、基于主体的模型，详细分析了从这22种可能的竞争矩阵中产生的进化和生态稳定的群落。在阿比特龙治疗之前，这些群体会随着ADT进化。此外，竞争矩阵的不同排列可能代表不同患者之间的差异（肿瘤细胞组成差异）。对于下面的模拟和六种类型间竞争系数的任意给定排序，我们使用了0.4、0.5、0.6、0.7、0.8和0.9。

#### 模拟结果

- 最好结果反应

22种排列中有12个会促进$T-$缺失以及$T+$和$Tp$细胞的高频率。在模拟中，这些肿瘤类型对治疗反应良好，PSA大幅且相对持续下降。在适应性治疗下(当PSA高于50%时维持治疗，当PSA低于初始值的50%时停止治疗)，PSA的持续周期是可能的。总肿瘤负荷随着治疗而下降，然后在治疗结束后增加。表3中病患`#1`为该类别的代表性患者。

![image-20240426100142326](https://lniiwuw-pictures.oss-cn-beijing.aliyuncs.com/img/image-20240426100142326.png)

- 一般结果反应

4种排列导致了治疗开始时$T-$细胞的低频率。在标准护理（soc）模拟中，最初的反应强烈但不可持续（$T-$细胞的频率快速增加并导致进展）。在适应性治疗模拟中，仍然会发生进展，但TTP被大大延长。表3中病患`#2`为该类别的代表性患者

- 无反应

6种矩阵排列导致了$T-$细胞的高平衡频率($\ge 20\%$)。这些竞争矩阵对治疗没有反应，甚至不能使PSA测量的肿瘤负荷降低$50\%$。在模拟中，使用阿比特龙后，$T-$细胞迅速取代$Tp$和$T+$细胞，只会产生很小的初始反应或者没有反应。根据经验，一些男性对阿比特龙没有反应，被标记为无反应。际的试验将只涉及可能属于前两类矩阵组合的男性。

为了模拟对阿比特龙治疗有反应的男性的不同治疗策略，从上述有反应的类别选取了两种具有代表性的竞争系数配置（表3）。

由于肿瘤细胞数目与血清PSA之间的直接关系尚不清楚，==简单地假设每个细胞每单位时间产生一个单位的PSA，同时每单位时间内50%的PSA在====血清中衰减==，得到PSA模拟的动态变化方程为：
$$
\frac{dPSA}{dt}=\sum_{i=1}^{3}x_i-0.5\times PSA
$$
对于这两种竞争矩阵系数配置，我们模拟了四种治疗方案：

1. 不给予阿比特龙。
2. 无论模拟PSA值如何，持续给予阿比特龙。
3. 预先确定间歇性开/关阿比特龙的治疗方案，与已发表的使用间歇ADT治疗去势敏感疾病的试验方案相匹配。
4. 为了匹配临床试验方案，我们创建了一种适应性疗法，选择一个PSA值开始使用阿比特龙，当PSA值下降到该值的50%时停止阿比特龙治疗，当PSA增加到初始值时恢复阿比特龙治疗。

对于每个治疗模拟，初始化一个阿比特龙治疗前肿瘤。在该肿瘤中，每种细胞频率被设置为$LV$模型的平衡值（进化稳定策略，$ESS$），癌细胞的总体大小和PSA水平设置为未处理平衡值的$25\%$。为了模拟各种治疗方案，让模拟运行到PSA平衡值的$80\%$，将此作为mCRPC的进展值和医生启动阿比特龙治疗的触发值。当给予阿比特龙时，$Tp$细胞的承载能力$K_2$降到100，当停用阿比特龙时，承载能力$K_2$上升到10000。我们假设$T-$细胞接管整个肿瘤，病人发生放射学进展时，PSA水平应保持在阿比特龙治疗前平衡水平的$50\%$以上。

#### 试点临床试验

理论分析和模型模拟为先前的间歇性试验(例如SWOG 9346)的失败提供了明确的机制，并确定了一种简单但具有进化信息和患者特异性的策略来延长对阿比特龙的反应。在该试验中，通过基于模型中观察到的进化动力学的适应性治疗算法，将阿比特龙给予mCRPC患者。

试验中，每4周对患者进行一次实验室监测(全血细胞计数$CBC$、综合代谢指数$COMP$、乳酸脱氢酶$LDH$和前列腺特异性抗原$PSA$)。

## [模型代码](https://github.com/cunninghamjj/Integrating-evolutionarydynamics-into-treatment-of-mCRPC)



# 10. The Contribution of Evolutionary Game Theory to Understanding and Treating Cancer

[文章链接](https://link.springer.com/article/10.1007/s13235-021-00397-w)

## 摘要

演化博弈论从数学上概念化和分析生物间相互作用，其中生物体的适应性不仅取决于自己的特征，还取决于其他个体的特征。一般来说，个体如果不是明显的理性，后代会继承特征而非选择特征。癌症细胞由异质类型细胞组成，面临频率依赖的选择（频率依赖选择：细胞的增殖与否），癌症的进展是不同细胞类型之间的进化竞争，因此可以被视为一种进化游戏。

本文中，我们首先总结了演化博弈论在癌症建模和改善其治疗方面的现有工作。一些博弈论模型表明，人们可以通过进化疗法来预测和引导癌症的生态进化动态，使其进入更适合患者的状态。最近的一些研究和临床试验表明，这种疗法对提高患者存活率和降低药物毒性有很大的希望。此外，我们讨论了现有的癌症及其治疗的博弈论模型的临床意义，以及癌症生物学的发展需要更好地利用博弈论模型的全部潜力。最后，我们证明了用演化博弈论观察肿瘤具有医学意义，可以在临床发现和数学模型之间提供信息和创建同步。

## 一 介绍

癌症是一种由负责调节细胞分裂的基因功能异常引起的不受调节的增殖疾病。癌症的发展是由自然选择驱动，癌细胞表现出以下三种特征:

1. 可遗传变异的存在：可遗传性状在不同的癌细胞之间存在差异，是基因突变、表观遗传学、染色体重排和其他与遗传不稳定性相关的机制的结果。
2. 生存竞争：由于对有限空间和资源的竞争，增长有限。
3. 遗传变异对生存斗争的影响：细胞存活的可能性取决于它自身的性状和其它细胞的性状。随着时间的推移，具有更高生存和增殖机会特性的细胞将增加频率（频率依赖性选择）。

演化博弈游戏（`evolutionary game theory, EGT`）用于处理具有不同策略或不同性状的生物体相互作用。与经典博弈论不同，这些生物体不需要完全理性，它们的策略往往是遗传的，而非理性选择，采用高适应度策略的个体将在长期内统治种群。==我们可以将癌症描述为一个进化游戏，其中癌细胞是参与者，策略是它们的遗传特征，收益则是以生存和增殖（适应度）来表示==。因此，人们可以分析采取不同策略的个体的数量变化。

治疗癌症的标准治疗(`Standard of Care, SoC`)通常采用最大耐受剂量(`Maximum Tolerable Dos, MTD`)治疗。对于一些侵袭性癌症，如晚期非小细胞肺癌，迄今为止还没有发现比MTD更好的治疗方法。然而，MTD策略会促进治疗诱导的耐药性进化，从而导致治疗失败（除非患者被治愈）。由于人类基因组的适应潜力，针对癌症遗传特征和个体遗传倾向的个性化治疗也会失败。MTD方案只能根除药物敏感细胞，对于耐药细胞而言，竞争导致的生长限制可能会暂时消失，其比例将会增加。一些实验表明，当停止治疗时，耐药细胞因需要耐药成本而处于不利地位，说明MTD方案促进癌细胞的耐药性在进化学上是不明智的。

### 数学背景

在肿瘤动态环境中，癌细胞之间、癌细胞和正常细胞之间都进行着进化博弈。不同类型细胞对特定治疗或治疗组合的抗性不同。对于转移性去势抵抗性前列腺癌(`metastatic Castrate-Resistant Prostate Cancer, mCRPC`)和雌激素受体阳性(`Estrogen Receptor Positive, ER+`)乳腺癌，已经发现了对特定治疗不同抵抗水平的癌细胞类型。对于研究较少的癌症，由于癌细胞的耐药水平不同或耐药水平随着治疗变化而变化，癌细胞类型尚未确认。

在普遍的癌症博弈论的模型中，特定类型的癌细胞对特定治疗的抵抗是一种持续进化的遗传特征。我们将Vincent和Brown的原始模型扩展到更多的维度，采用达尔文动力学的方法来描述这种情况。

向量 $x(t)=(x_1(t),...,x_n(t))^T$ 定义了所有类型癌细胞 $\tau=\{1,2,...,n\}$在时间 $t$ 的种群密度（种群大小）。第 $i$ 类癌细胞的动态变化方程为：
$$
\frac{dx_i(t)}{dt}=x_i(t)\cdot H_i\big(U(t),x(t),m(t)\big) \tag{1}
$$

其中

- $U(t)=\big(u_{ij}(t)\big)$是耐药抗性矩阵，$u_{ij}(t)\in [0,1]$表示 $i$ 型细胞对 $j\in \Theta=\{1,...,p\}$​ 型治疗方案的耐药抗性。
- $m(t)=\big(m_1(t),m_2(t),...,m_p(t)\big)$ 表示治疗集合 $\Theta$ 中的每种治疗方案的剂量，$m_j(t)=0$ 和 $m_j(t)=1$ 表示 $t$ 时刻的无治疗和MTD治疗方案。
- $H_i\big(U(t),x(t),m(t)\big) \tag{1}$ 表示 $i$ 型细胞的单位时间增长率，其明确依赖于 $x(t)$。

Vincent和Brown提出了种群动态的适应度生成函数($G$ 函数)，使用单一的数学表达式来描述许多物种(或类型)的适应度。$G$ 函数表示式为：
$$
G\big(v(t),U(t),x(t),m(t)\big) \mid_{v(t)=\big(u_{i1}(t),...,u_{ip}(t)\big)}=H_i\big(U(t),x(t),m(t)\big) \tag{2}
$$
其中 $v$ 为虚拟向量变量，将等式的 $v_j(t)$ 替换为 $u_{ij}(t)$ 得到 $i$ 类癌细胞的适应度。

故方程（1）可重写为：
$$
\frac{dx_i(t)}{dt}=x_i(t)\cdot G\big(v(t),U(t),x(t),m(t)\big) \mid_{v(t)=\big(u_{i1}(t),...,u_{ip}(t)\big)} \tag{3}
$$
$u_{i,j}(t)$ 的动态变化方程为：
$$
\frac{du_{ij}(t)}{dt}=k_{ij} \frac{\partial H_i\big(U(t),x(t),m(t)\big)}{\partial u_{i,j}(t)}
\tag{4}
$$
用 $G$ 函数重写为:
$$
\frac{du_{ij}(t)}{dt}=
k_{ij} \frac{G\big(v(t),U(t),x(t),m(t)\big)}{\partial u_{i,j}(t)}

\mid_{v(t)=\big(u_{i1}(t),...,u_{ip}(t)\big)}
\tag{5}
$$

方程(3)和（5）描述了癌细胞的生态和进化动力学。

其中

- $K_{ij}$ 是速度参数，是遗传上的一个度量，符合Fisher的自然选择基本定理。在自适应动力学中，$k_{ij}$ 随种群规模线性增加。为了简单起见，在建模时，通常假设对于所有的 $i$ 和  $j$ ，$k_{ij}$ 都是一样的。

下文使用$U、x、m$来代替$U(t)、x(t)、m(t)$​。

生态动力学方程（3）收敛于一个稳定平衡点 $x^* \ge 0$ ，则称该点为生态平衡点。方程（3）和（5）通常确定 $x(m)$ 和 $U(t)$ 的平衡解，用 $x^*(m)$ 和 $U^*(m)$ 表示。对于 $m$ 的特定选择，如果$x^*(m)$ 和 $U^*(m)$ 能够抵抗其他突变策略的入侵，那么称为进化稳定策略（`ESS`）。ESS的一个必要条件是  $G$ 函数在相应的 $x^*$ 处使 $G$ 相对于 $v$ 达到最大值。

## 二 没有治疗或有预先设定治疗方案的癌症博弈论

在没有或有预先治疗方案 $m$ 的癌症 $EGT$ 模型的文献中，作者要么专注于在生态平衡 $x^*$ 处寻找 $ESS$ 抗性策略 $U^∗$，要么分析特定(预先定义)的 $m$  对应的$(x^∗，U^∗)$的瞬态动力学，以分析哪些 $m$ 在某些预先指定的指标(如无进展或总生存)更优。

### 2.1 方程3和5描述的生态进化动力学方程

Reed等人提出了下述 $G$ 函数用于治疗小儿肉瘤
$$
G=r\big((1-v_1)(1-v_2)(1-v_3)-\frac{x}{K}\big)-\mu_1(v_1)-\mu_2(v_2)-\mu_3(v_3)
\tag{6}
$$
其中

- $v_i$ 表示对治疗 $i\in\{1,2,3\}$ 的诱导抗性
- $r$ 表示肿瘤细胞的内在生长率
- $x$ 为细胞密度
- $K$ 为承载肿瘤细胞能力
- $u_i(v_i)=\frac{m_i}{k_i+b_iv_i}$ 表示治疗方案 $i$ 引起的死亡率。$m_i$ 为治疗下肿瘤细胞的基本死亡率，$k_i$ 为先天抗性，$b_i$ 表示对治疗 $i$ 的耐药性所带来的好处。

在不同的数值模拟下，该文献表明：当小儿肉瘤可治愈时，可以通过增加第一次治疗或在疾病进展之前紧密进行第二次治疗，以此提高治愈可能性。相反，当认为无法治愈时，Reed等人提出了Zhang等人用于转移性去势抵抗性前列腺癌的适应性治疗方案（2.5章节）。

### 2.2 具备适应度矩阵的复制动力学

由癌细胞的适应度矩阵给出的博弈论模型最简单直观，这些模型假设癌细胞相互作用，细胞繁殖产生与亲本细胞相同类型的后代。

定义 $a_{ij}$ 为 $i$ 型癌细胞在 $j$ 型癌细胞的作用下，产生子代的期望数目或者产生子代的概率。如果有 $n$ 种癌细胞并且知道 $a_{i,j}$ $\forall i,j \in \{1,2,...,n\}$，可以用细胞的比例 $ q_{i}=\frac{x_i}{\sum_{i=1}^{n}{x_i}}$ 代替种群密度x描述种群动态，动态变换方程为
$$
\frac{dq_i}{dt}=q_i\big((Aq)_i-q^TAq\big)
\tag{7}
$$
其中

- $i$ 型癌细胞的单位增长率 = 预期收益 $(Aq)_i$ - 种群平均收益 $q^TAq$​
- $\sum_{i=1}^{n}q_i=1$

复制动态变化方程（7）只考虑了种群比例方面的动态变化，而没有考虑癌细胞的进化动力学（耐药抗性 $U$​ 不发生改变），是（3）和（5）的一个特例。

如Zeeman所示，矩阵A的任何ESS都是复制动态方程（7）的稳定平衡点。如果在肿瘤中存在这样的ESS，那么可以使用现有治疗手段显著提高无进展生存期和总生存期，实现肿瘤的长期稳定。（然而，由于所涉及的时间尺度，可能无法达到平衡，例如由于种群规模的生态限制 。）？？？？

Basanta等人提出的“Go-vs-Grow game”模型，是最早通过适应度矩阵来定义癌细胞竞争相互作用的模型之一。该模型被迅速包含到糖酵解，Basanta等人在文章中介绍了侵袭型(Go)、自主生长型(Grow)和糖酵解型(GLY)三种癌细胞类型之间的相互作用，分析了适应度矩阵A中不同参数对博弈特征和ESSs的影响。

### 2.3 适应度矩阵参数的估计

通过体外实验数据估计适应度矩阵的参数，两种癌细胞（抗性q和非抗性1-q）的种群比例变化方程为
$$
\frac{dq}{dt}=q(1-q)\big((a_{12}-a{22})(1-q)-(a_{21}-a{11})q\big)
\tag{8}
$$


### 2.4 具有非线性适应度函数的复制动力学

动态变化方程（7）的适应度函数 $(Aq)_i$ 为线性函数，但可以推广到非线性适应度函数。
$$
\frac{dq_i}{dt}=q_i\big(f_i(q)-\sum_{j=1}^{n}q_jf_j(q)\big)
\tag{9}
$$
其中，适应度函数 $f_i$ 可以是非线性的。

这种非线性适应度函数的情况已经在公共物品博弈中产生了广泛的理论研究，其中细胞可以是生产者(合作者)或免费利用其他细胞(叛逃者)生产的共享资源。

### 2.5 Lotka–Volterra模型

LV方程分别由Lotka和Volterra提出，用于描述一组模型中的竞争和另一组模型中的捕食者-猎物动力学。在这里，我们将自己局限于竞争模型。

虽然最初的LV动力学只描述了两个物种之间的相互作用，但它们可以扩展到n种类型的癌细胞的相互作用。此外，通过将适应度矩阵A转换为LV模型的竞争矩阵并保持相同的稳定均衡(吸引子)，可以将n种类型的复制子动力学转换为具有n−1种类型的LV模型，反之亦然。

最具影响力的肿瘤动力学LV竞争模型是Zhang等人的LV竞争模型（详见上述第9篇文章）。

Cunningham等人从Zhang等人的LV竞争模型开始采用最优控制理论，根据肿瘤总负荷方差最小等不同标准对阿比特龙治疗方案进行了优化。这将在第3节中进行更详细的讨论。

### 2.6 空间博弈论模型及相关工作（略）

## 三 癌症治疗博弈论

## 四 临床相关

## 五 讨论
